!function(e){function t(t){for(var s,n,a=t[0],c=t[1],l=t[2],u=0,_=[];u<a.length;u++)n=a[u],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&_.push(r[n][0]),r[n]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);for(d&&d(t);_.length;)_.shift()();return i.push.apply(i,l||[]),o()}function o(){for(var e,t=0;t<i.length;t++){for(var o=i[t],s=!0,a=1;a<o.length;a++){var c=o[a];0!==r[c]&&(s=!1)}s&&(i.splice(t--,1),e=n(n.s=o[0]))}return e}var s={},r={"web/feed":0},i=[];function n(t){if(s[t])return s[t].exports;var o=s[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=s,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(o,s,function(t){return e[t]}.bind(null,s));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/js/cmodules/";var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var d=c;i.push([156,"vendors","common","d14210db89a37ef97acca2f934f28b98","d14cf8a35640ddac42850d9e4cb772f6"]),o()}({156:function(e,t,o){e.exports=o("e/IV")},"9I9X":function(__webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"evalWithLogging",(function(){return evalWithLogging}));var _web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("98sY"),evalWithLogging=evalString=>{try{return eval(evalString)}catch(e){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_0__.logEvalError)(e,evalString)}}},"e/IV":function(e,t,o){"use strict";o.r(t);o("a1Th"),o("Btvt"),o("rGqo"),o("rE2o"),o("ioFf"),o("HEwt"),o("Vd3H"),o("OG14"),o("pIFo"),o("SRfc"),o("KKXr");var s=o("D1OX"),r=o("zxIV"),i=o("9I9X"),n=o("o7bv"),a=o("v+DW"),c=o("EasH"),l=o("FWc3"),d=o("t/FQ"),u=o("XzvV"),_=o("t7n3"),f=o("2vnv"),p=o("rwc4"),h=o("BJj/"),g=o("jE6c"),v=o("zuld"),m=e=>{for(var t=indexOf(domPN(e).children,e),o=domFC(e);o&&"moat"===o.id.slice(0,4);)o=domNS(o);var s,r,i,n=/^post(-?\d+_\d+)$/,a={};if(!o)return a;if("ads_feed_placeholder"===o.id)return a;a.module=cur.module,a.index=t,"feed"==cur.module&&("search"==cur.section?(a.module="feed_search",a.q=cur.q):"news"==cur.section?a.module=cur.subsection?"feed_news_"+cur.subsection:"feed_news":"recommended"==cur.section?a.module=cur.subsection?"feed_recommended_"+cur.subsection:"feed_recommended":"friends"==cur.section?a.module=cur.subsection?"feed_friends_"+cur.subsection:"feed_friends":"groups"==cur.section?a.module=cur.subsection?"feed_groups_"+cur.subsection:"feed_groups":"videos"==cur.section?a.module=cur.subsection?"feed_videos_"+cur.subsection:"feed_videos":"photos"==cur.section?a.module=cur.subsection?"feed_photos_"+cur.subsection:"feed_photos":"podcasts"==cur.section?a.module=cur.subsection?"feed_podcasts_"+cur.subsection:"feed_podcasts":"list"==cur.section?a.module=cur.subsection?"feed_list_"+cur.subsection:"feed_list":a.module="feed_other");var c=o.getAttribute("data-ad-view");c&&(a["ad_"+c]=1);var l=o.getAttribute("post_view_hash");if(l&&(a.hash=l),"block_"===o.id.substr(0,6)){a[o.id]=1,a.block=o.id.substr(6);var d=attr(o,"data-contain");d&&(d=d.split(",")).forEach((function(e){e=e.split(":"),a[e[0]]=intval(e[1])||1}));var u=attr(o,"data-contain-ids");u&&(a.contain_ids=u)}else if(r=o.id.match(n))a[r[1]]=1;else if(r=o.id.match(/^post(adsite.*)$/))a[r[1]]=1;else if(r=(s=o.className).match(/feed_reposts_wrap(-?\d+_\d+)/)){if(i=domFC(o),hasClass(domFC(i),"post_copy")&&(a[r[1]]=-1),(r=domFC(i).id.match(n))&&(a[r[1]]=1),isVisible(i=domNS(i)))for(i=domFC(i);i;i=domNS(i))(r=i.id.match(n))&&(a[r[1]]=1)}else if(r=s.match(/feed_repost(-?\d+_\d+)/))i=domFC(o),hasClass(i,"post_copy")&&(a[r[1]]=-1),(r=i.id.match(n))&&(a[r[1]]=1);else{var _=o.id;hasClass(o,"post_photos")&&(i=geByClass1("post_image",o,"a"))&&(i=domFC(i))&&(r=i.getAttribute("data-post-id").match(/^(-?\d+_p?\d+)$/))&&(_=r[1]),a[_]=1}return a},w=e=>{var t=e&&domFC(e);return t&&t.hasAttribute("data-ad-video-autoplay")},b=e=>{var t=e&&domFC(e);return t&&t.hasAttribute("data-ad-views-long-only")},y=((e,t)=>{var o,s=!1;return function(){return!0===s||(o=e(...arguments),s=t(o)),o}})(()=>ge("page_header").offsetHeight,e=>!!e),C={tracking:[],viewed:{}},k=(e,t)=>{var o=C.tracking,s=C.viewed;if(0===o.length)return[];var r=[];return each(o,(function(o,i){var n=domFC(i),a=n.id;if(n&&a){var c=domData(n,"ad-block-uid"),l=""+a;if(c&&(l+="_"+c),!s[l]&&document.body.contains(i))if(((e,t,o,s)=>{var r=y(),i=o+r,n=o+s,a=e.offsetHeight,c=e.offsetTop+r,l=c+a;return(l>i&&c<n?(Math.min(n,l)-Math.max(i,c))/a:0)>=t})(i,.5,e,t)){var d=Date.now();i.longViewStartedAt?d-i.longViewStartedAt>=1e3&&(s[l]=!0,r.push(extend({},m(i),{long:1}))):i.longViewStartedAt=Date.now()}else i.longViewStartedAt=null}})),r},P=e=>!!e&&(!!e.longViewTracking||!e.longViewRegistered&&(e.longViewRegistered=!0,e.longViewTracking=w(e)||(e=>{var t=e&&domFC(e);return t&&(t.hasAttribute("data-ad-stat-impression_long")||t.hasAttribute("data-ad-disabled-stat-impression_long"))})(e)||b(e),!!e.longViewTracking&&(C.tracking.push(e),!0))),S=o("/PiP"),x=o("Bj12"),E={market:"al_market.php"},L={getNewMarketItemsBox:"get_new_items_box"},B="#feed_rows",T=".feed_row",j={showItem:function(e,t,o,s){e&&(Object(S.showWiki)({w:"product"+e,from:"feed"}),j.logClick(t,o,s,e))},showAll:function(e,t,o){Object(c.showBox)(E.market,{act:L.getNewMarketItemsBox},{params:{hideButtons:!0,width:550,grey:!0,containerClass:"MarketItemsFeedBlockBox",bodyStyle:"padding: 20px 0 0;",onHide:function(){var e,t;return null===(t=null===(e=window.Marketplace)||void 0===e?void 0:e.scroll)||void 0===t?void 0:t.deinit()}}}),j.logClick(e,t,o)},logClick:function(e,t,o,s){var r;if(e&&t&&o){var i=(null===(r=window.Feed)||void 0===r?void 0:r.getModuleRef())||"",n=e.closest(B),a=n?Array.from(n.children):[],c=e.closest(T),l=c?a.indexOf(c):0,d=window.cur.feed_session_id||0;Object(x.saveStatlogEvents)({name:t,value:o,keys:[i,l,d,s||""]})}}};function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var o=[],s=!0,r=!1,i=void 0;try{for(var n,a=e[Symbol.iterator]();!(s=(n=a.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(e){r=!0,i=e}finally{try{s||null==a.return||a.return()}finally{if(r)throw i}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(o);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,s=new Array(t);o<t;o++)s[o]=e[o];return s}var R={sectionUpdateExceptions:["search","notifications","photos_search","mentions","articles","articles_search","likes","recommended","live","topics"],blockHideReason:function e(t,o){if(e.progress)return!1;e.progress=!0;var s="block_"+t,r=ge(s);delete cur.feedEntriesHTML[s],ajax.post("al_feed.php",{act:"a_block_hide_reason",block_id:t,reason:0|o,hash:attr(r,"data-hash"),ref:R.getModuleRef(),pos:attr(r,"data-pos")},{onDone:function(t){e.progress=!1,t?val(r,t):hide(r)},hideProgress:function(){e.progress=!1}})},blockRestore:function(e){var t="block_"+e,o=ge(t);cur.feedEntriesHTML[t]&&val(t,cur.feedEntriesHTML[t]),ajax.post("al_feed.php",{act:"a_block_restore",block_id:e,hash:attr(o,"data-hash"),ref:R.getModuleRef(),pos:attr(o,"data-pos")})},blockHide:function(e,t){if(!Object(a.actionsMenuItemLocked)(t)){Object(a.lockActionsMenuItem)(t);var o="block_"+e,s=ge(o),r=geByClass1("ui_actions_menu_wrap",s);ajax.post("al_feed.php",{act:"a_block_hide",block_id:e,hash:attr(s,"data-hash"),ref:R.getModuleRef(),pos:attr(s,"data-pos")},{onDone:function(e){uiActionsMenu.toggle(r,!1),cur.feedEntriesHTML[o]=val(s),val(s,e)},hideProgress:a.unlockActionsMenuItem.pbind(t)})}},videoRecomsBlockHideCancel:function(){ajax.post("/al_feed.php",{act:"a_video_recom_hide_cancel"}),R.restorePost("video_recoms")},videoRecomsBlockHideReason:function(e,t){re(geByClass1("feed_rb_video_reason_wrap")),show(geByClass1("feed_rb_video_reason_thankyou")),ajax.post("/al_feed.php",{act:"a_video_recom_hide_reason",reason:t,reason_hash:e})},expandVideosPost:function(e,t){var o=geByClass1("page_post_sized_thumbs",domPN(t)),s=0;each(o.children,(function(){if(!isVisible(this)&&(show(this),++s>5))return!1})),toggle(t,!isVisible(o.children[o.children.length-1]))},closeVideoBlock:function(e){ajax.post("al_feed.php",{act:"a_close_video_block",hash:e});var t=ge("feed_recommends");setStyle(t,{height:getSize(t)[1],opacity:1}),setTimeout((function(){addClass(t,"recoms_hidden")}))},update:function(e){if(!cur.feedUpdateLoading&&!(window.Notifier&&cur.add_queues&&cur.add_queues.length&&(cur.add_queues.forEach((function(e){Notifier.addKey(e,R.updated)})),"news"!=cur.section)||"feed"!==cur.module||"top"==cur.subsection||inArray(cur.section,R.sectionUpdateExceptions))){var t=Math.random();if(!("news"!=cur.section&&"comments"!=cur.section&&t>.3||"news"==cur.section&&(e||t>.05))){cur.feedUpdateLoading=!0;var o=R.getSectionParams(cur.section);extend(o,cur.navParams),ajax.post("al_feed.php?au_"+cur.section,extend(o,{timestamp:cur.timestamp,posted:e?1:"",queue:cur.add_feed_queue?1:0}),{onDone:function(t,o,s){if(cur.feedUpdateLoading=!1,1!=e||o&&-1!=o.indexOf(vk.id+"")){if(!("feed"!==cur.module||t.section!=cur.section||t.timestamp<cur.timestamp||s<cur.timestamp)){Object(u.statlogsValueEvent)("feed_check_update",!!o),t.count+=cur.count;var r,i,n,a,c=cur.rowsCont,l=ce("div"),_=0;if("news"==cur.section){if(a=scrollGetY(),o){for(l.innerHTML=o;l.lastChild;)r=l.lastChild,c.insertBefore(r,c.firstChild),R.onPostLoaded(r,!0);each(geByClass("ts"+s,c),(function(){_+=this.offsetHeight,Object(d.nodeUpdated)(this),cur.feedUnreadCount++}))}_&&a>100&&scrollToY(a+_,0,!1,!0)}else if(o)for(l.innerHTML=o;r=l.lastChild;)if("DIV"==r.tagName)if("podcasts_recommended_block"!==r.id)if((n=r.firstChild.id.substr(4))&&cur.wallLayer==n)l.removeChild(r);else if(i=ge("post"+n)){var f=function(){if(!hasClass(i.parentNode,"feed_row"))return{v:void 0};var e=ge("replies"+n),t=e.nextSibling,o=0;if(each([].slice.call(geByClass("reply",r,"div")),(function(){ge(this.id)||(addClass(this,"new_reply"),e.appendChild(this),o++)})),o){var s=i.parentNode.offsetHeight,a=geByClass("new_reply",e,"div").length;t&&"replies_open"==t.className||(t=ce("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(n),role:"button",tabIndex:0}),e.parentNode.insertBefore(t,e.nextSibling)),t.innerHTML=getLang("wall_x_new_replies_more",Math.min(100,a)),t.newCnt=a;var d=scrollGetY(),u=window.innerHeight||document.documentElement.clientHeight||bodyNode.clientHeight,_=getXY(t)[1],f=i.parentNode.offsetHeight;s=f-s,inArray(n,cur.feedUnread)||cur.feedUnread.unshift(n),!cur.idleManager.isIdle&&_>d+100&&_<d+u+100?(c.insertBefore(ge("post_ph"+n)||ce("div",{id:"post_ph"+n}),c.firstChild),inArray(n,cur.feedToSort)||cur.feedToSort.push(n)):(re(i.parentNode),c.insertBefore(i.parentNode,c.firstChild),_>d+u+100&&(s=f),s&&scrollToY(scrollGetY()+s,0,!1,!0)),cur.feedUnreadCount+=o}l.removeChild(r)}();if("object"==typeof f)return f.v}else a=scrollGetY(),c.insertBefore(r,c.firstChild),R.onPostLoaded(r,!0),Object(d.nodeUpdated)(r),_=r.offsetHeight,a>100&&scrollToY(a+_,0,!1,!0);else l.removeChild(r);else l.removeChild(r);R.applyOptions(t),R.updateTitle()}}else setTimeout(R.update.pbind(2),2e3)},onFail:function(){return cur.feedUpdateLoading=!1,!1},showProgress:function(){cur.feedUpdateLoading=!0},hideProgress:function(){cur.feedUpdateLoading=!1}})}}},getNewQKey:function(e){var t={act:"a_get_key",only_update:cur.add_feed_queue?1:0,need_ignore:isArray(cur.ignore_owners)?0:1},o={onDone:function(o,r,i){if(cur.section!=s)return;if(cur.add_feed_queue=i,o)cur.add_queues=o,setTimeout(R.update.pbind(0),0);else if(!t.only_update){var n=r;return void(cur.timestamp=(n||vkNow()/1e3)-e)}isArray(r)&&(cur.ignore_owners=r)},local:1},s=cur.section;ajax.post("al_feed.php?queue",extend(R.getSectionParams(cur.section),t),o)},updated:function(e,t){cur.queueTO=cur.queueTO||irand(0,5e3),setTimeout(R.handleQueueEvent.pbind(e,t),cur.queueTO)},handleQueueEvent:function(e,t){if(("search"==cur.section||"news"==cur.section||!cur.section)&&isArray(cur.add_queues)){var o=!1;if(cur.add_queues.forEach((function(t){t.key===e&&(o=t)})),o){if(t.failed){cur.add_queues=!1,cur.add_feed_queue=null;var s=curNotifier.error_timeout||1;return clearTimeout(cur.lp_error_to),void(cur.lp_error_to=setTimeout(R.getNewQKey.bind(R).pbind(s),1e3*s))}if(isArray(t.events)&&t.events.length){o.ts=t.ts,t.key&&(o.key=t.key);var r=scrollGetY(),i=0;each(t.events,(function(){if(isObject(this))return Wall.processQueueEvent(this);i+=R.pushEvent(this.split("<!>"),r+getSize("page_header_cont")[1])}));var n=scrollGetY();i&&Math.abs(r-n)<100&&(cur.leftMenuDelta=i,scrollToY(n+i,0,!1,!0)),R.updateTitle(),cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler()}}}},needScrollPost:function(e,t){return e+80>getXY(t)[1]||cur.storyLayer||window.mvcur&&mvcur.mvShown||window.pvcur&&cur.pvShown},pushEvent:function(e,t){var o=e[0],s=e[1],r=e[2],i=ge("post"+r),n=cur.section,a="search"!=n?intval(e.pop()):0,c=0,l=function(e){return intval(getStyle(domByClass(e,"page_block"),"marginTop"))||intval(getStyle(domByClass(domNS(e),"page_block"),"marginTop"))||15};if(!cur.options||o!=cur.options.qversion)return 0;switch((Wall.isArchiveWall()?"archive_post"===s:"reveal_post"===s)&&(s="res_post"),(Wall.isArchiveWall()?"reveal_post"===s:"archive_post"===s)&&(s="del_post"),s){case"new_post":if(i)break;var _=constants.Groups.GROUPS_ADMIN_LEVEL_USER;if(intval(e[11])&&intval(e[11])!=vk.id)return ajax.post("al_feed.php",{act:"a_need_own_reply",oid:intval(e[11])},{onDone:function(o){o&&(e[11]=0,R.pushEvent(e,t))}}),0;if("search"!=n){var f=r.split("_")[0];e[8]=intval(e[8])>0&&4==(4&a)?1:0,f<0&&(_=8&a?constants.Groups.GROUPS_ADMIN_LEVEL_EDITOR:2&a?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER)}"search"==n&&Object(u.statlogsValueEvent)("feed_switch",0,"search_update",cur.options.q&&"#"==cur.options.q.charAt(0)?"hashtag":"");var p,h,g,v,m,w,b=cur.rowsCont,y=b.childNodes,C=Wall.getNewPostHTML(e,_,R.feedPostRepl),k=e[12],P="search"!=n&&(window._wf<=0||hasClass(cur.feedEls.wrap,"feed_has_new")||R.needScrollPost(t,b)),S=cur.storyLayer;S&&(P=!0);var x=!1,E=C;if(P&&(C=Wall.updatePostImages(C)),k){if(cur.ignore_owners.length&&inArray(intval(k),cur.ignore_owners))break;if(h=geByClass1("feed_reposts_wrap"+k,b,"div"))g=geByClass1("feed_reposts_first",h,"div").firstChild,v=geByClass1("feed_reposts_group",h,"div"),m=geByClass1("feed_reposts_more_link",h,"a"),R.needScrollPost(t,g)&&(c-=g.offsetHeight+l(g)),g.parentNode.replaceChild(p=se(E),g),v.insertBefore(g,v.firstChild),isVisible(v)||val(m,getLang("news_show_X_reposts",v.childNodes.length)),h=h.parentNode,b.firstChild!=h&&b.insertBefore(h,b.firstChild),R.needScrollPost(t,h)&&(c+=h.offsetHeight+l(h)),h.bits=0;else if((w=geByClass("feed_repost"+k,b,"div"))&&w.length){C=rs(cur.wallTpl.grouped_posts,{place:k,random:irand(1e8,2e8),first:C,other:"",label:getLang("news_show_X_reposts",w.length)});var L=se('<div class="feed_row'+(P?"_unshown":"")+'">'+C+"</div>");Wall.updateAnonNewPost(e,L),b.insertBefore(L,b.firstChild),!P&&R.needScrollPost(t,L)&&(c+=L.offsetHeight+l(L)),x=!0,h=L.firstChild,p=geByClass1("feed_reposts_first",h,"div"),v=geByClass1("feed_reposts_group",h,"div"),each(clone(w),(function(){R.needScrollPost(t,this)&&(c-=this.offsetHeight+l(this)),re(this.parentNode),v.appendChild(this.firstChild)}))}else p=se('<div class="feed_row'+(P?"_unshown":"")+'"><div class="feed_repost'+k+'">'+C+"</div></div>"),Wall.updateAnonNewPost(e,p),b.insertBefore(p,b.firstChild),x=!0,!P&&R.needScrollPost(t,p)&&(c+=p.offsetHeight+l(p))}else p=se('<div class="feed_row'+(P?"_unshown":"")+'">'+C+"</div>"),Wall.updateAnonNewPost(e,p),b.insertBefore(p,b.firstChild),x=!0,!P&&R.needScrollPost(t,p)&&(c+=p.offsetHeight+l(p));if(0==e[8]){var B=geByClass1("post",p);addClass(B,"closed_comments")}if(cur.deepRepliesActive){var T=geByClass1("post",p);addClass(T,"deep_active")}P&&x&&(cur.newPostsCount=cur.newPostsCount?cur.newPostsCount+1:1,cur.feedEls.newPosts.innerHTML=getLang("news_new_posts",cur.newPostsCount),addClass(cur.feedEls.wrap,"feed_has_new"),1==cur.newPostsCount&&R.needScrollPost(t,cur.feedEls.newPosts)&&!S&&(c+=getSize(cur.feedEls.newPosts)[1])),AudioUtils.updateQueueReceivedPost(p),cur.feedUnreadCount++,"search"!=n&&Object(d.nodeUpdated)(p),y.length>300?b.removeChild(y[300]):y.length<=1&&removeClass(cur.feedEls.wrap,"feed_is_empty"),Wall.updateMentionsIndex();break;case"new_post_reply":if(i)break;var j=cur.rowsCont,M=j.childNodes,O=Wall.getNewPostHTML(e,!1,R.feedPostRepl),A=se('<div class="feed_row">'+O+"</div>");j.insertBefore(A,j.firstChild),R.needScrollPost(t,A)&&(c+=A.offsetHeight+l(A)),cur.feedUnreadCount++,M.length>300?j.removeChild(M[300]):M.length<=1&&removeClass(cur.feedEls.wrap,"feed_is_empty");break;case"edit_post":var H,N=ge("wpt"+r);if(!isVisible(i)||!N)break;var I=geByClass1("wall_post_more",N);I&&(I=isVisible(domNS(I))),(H=R.needScrollPost(t,N))&&(c-=N.offsetHeight);var D=psr(rs(e[3],{poll_hash:cur.wallTpl.poll_hash})),V=ge("post"+r);V&&!isVisible(V.parentNode)&&(D=Wall.updatePostImages(D)),val(N,D),I&&(I=geByClass1("wall_post_more",N))&&I.onclick(),H&&(c+=N.offsetHeight),Object(d.nodeUpdated)(N),window.Wall&&Wall.updatePostAuthorData(r);break;case"edit_reply":var q=e[3],F=ge("wpt"+q);if(!isVisible("post"+q)||!F)break;var W=geByClass1("wall_reply_more",F);W&&(W=isVisible(domNS(W)));var U=psr(e[4]);val(F,U),W&&(W=geByClass1("wall_reply_more",F))&&W.onclick(),Object(d.nodeUpdated)(F);break;case"post_parsed_link":if(!i)break;var G=geByClass1("wall_postlink_preview_btn_disabled",i);if(!G)break;var z=e[3];if("1"===z)removeClass(G,"wall_postlink_preview_btn_disabled");else if("0"===z)re(G);else if(z){removeClass(G,"wall_postlink_preview_btn_disabled");var Y=geByClass1("flat_button",G);Y&&(Y.setAttribute("href",e[3]),Y.removeAttribute("onclick"))}break;case"del_post":if(i){var X=domClosest("feed_row",i)||domClosest("feed_row_unshown",i)||i;cur.wallMyDeleted[r]||(R.needScrollPost(t,i)&&(c-=i.offsetHeight+l(i)),revertLastInlineVideo(i),re(X)),cur.options.offset--,hasClass(cur.feedEls.wrap,"feed_has_new")&&!isVisible(X)&&(cur.newPostsCount--,cur.newPostsCount?cur.feedEls.newPosts.innerHTML=getLang("news_new_posts",cur.newPostsCount):removeClass(cur.feedEls.wrap,"feed_has_new"))}break;case"res_post":i&&cur.options.offset++;break;case"new_reply":if(!i||cur.wallMyReplied[r]||ge("post"+e[3]))break;if(hasClass(ge("post"+r),"deep_active")){var Q=Wall.addNewReply(e);c+=Q[0];break}var $,K=ge("replies"+r),J=ge("replies_wrap"+r),Z=i.offsetHeight,ee=r.split("_")[0]<0?8&a?constants.Groups.GROUPS_ADMIN_LEVEL_EDITOR:2&a?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER:constants.Groups.GROUPS_ADMIN_LEVEL_USER,te=Wall.getNewReplyHTML(e,ee),oe=!1,ie=!1;if(isVisible(K)&&isVisible(J)&&!isVisible("reply_link"+r)){$=K.nextSibling;var ne=geByClass("new_reply",K,"div").length+1;if(cur.wallMyOpened[r]){$&&"replies_open"==$.className&&re($),ie=!0;var ae=geByClass1("wr_header",K,"a"),le=geByClass("reply",K,"div").length+1,de=le;ae&&(de=intval(ae.getAttribute("offs").split("/")[1])+1),(de>5||le<de)&&(ae||K.insertBefore(ae=ce("a",{className:"wr_header"}),K.firstChild),Wall.updateRepliesHeader(r,ae,le,de))}else te=Wall.updatePostImages(te),oe=se(te),addClass(oe,"new_reply"),$&&"replies_open"==$.className||($=ce("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(r),role:"button",tabIndex:0}),K.parentNode.insertBefore($,K.nextSibling)),$.innerHTML=getLang("wall_x_new_replies_more",Math.min(100,ne)),$.newCnt=ne}else re("reply_link"+r),show(J,K),ie=!0;r.split("_")[0]==vk.id&&cur.feedUnreadCount++,oe||(oe=se(te)),K.appendChild(oe),R.needScrollPost(t,ie?oe:$)&&(c+=i.offsetHeight-Z),ie&&Object(d.nodeUpdated)(oe),Wall.repliesSideSetup(r),Wall.updateMentionsIndex(),Likes.update("wall"+r,{comment_num:e[13]});break;case"del_reply":if(!cur.wallMyDeleted[r]&&i){if(hasClass(gpeByClass("post",i),"deep_active")){var ue=Wall.removeDeepReply(e);c+=ue[0];break}R.needScrollPost(t,i)&&(c-=i.offsetHeight);var _e=i.parentNode.id.match(/replies(-?\d+_\d+)/);revertLastInlineVideo(i),re(i),_e&&Wall.repliesSideSetup(_e[1])}break;case"view_post":Likes.update("wall"+r,{views_num:Wall.formatCount(intval(e[3]))});break;case"like_post":case"like_reply":if(!i)break;var fe="like_reply"==s?"wall_reply"+r:r,pe=i&&domByClass(i,"_like_wrap"),he=i&&domByClass(i,"_share_wrap");Wall.likeFullUpdate(pe,fe,{like_my:pe&&hasClass(pe,"my_like"),like_num:e[3],like_title:!1,share_my:he&&hasClass(he,"my_share"),share_num:e[4],share_title:!1})}return c},feedPostRepl:function(e,t){e.replies=cur.wallTpl.post_replies;var o={full_id:t[2],item_id:"wall_"+t[2],sec_name:stripHTML(t[3]),date:Wall.getNowRelTime(),del:cur.wallTpl.spam};if("search"==cur.section&&cur.q){var s,r,i,n=e.text||"",a=cur.q.toLowerCase().split(/[\s.,:;!?()]/),c=[],l=(n=n.replace(/<(.|\n)+?>/g,(function(e){return c.push(e),""}))).toLowerCase();for(s=a.length-1;s>=0;s--)if(i=a[s],trim(i))for(r=0;-1!=(r=l.indexOf(i,r));)n.charAt(r-1)!=String.fromCharCode(2)?(n=n.substr(0,r)+""+s+""+n.substr(r+i.length),l=l.substr(0,r)+""+s+""+l.substr(r+i.length)):r+=2;n=(n=n.replace(/\x02(\d+)\x02/g,(function(e,t){return'<span class="highlight">'+a[t]+"</span>"}))).replace(/\x01/g,(function(){return c.shift()||""})),o.text=n,"new_post_reply"==t[1]&&(o.date_postfix=t[7])}return o},reSortItems:function(){cur.feedToSort&&cur.feedToSort.length&&(each(cur.feedToSort,(function(e,t){var o=ge("post_ph"+t),s=ge("post"+t).parentNode;o&&s&&(o.parentNode.insertBefore(s,o),re(o))})),cur.feedToSort=[],scrollToY(0,0))},showNewPosts:function(){removeClass(cur.feedEls.wrap,"feed_has_new"),cur.newPostsCount=0;var e=ge("feed_rows");Wall.loadPostImages(e),each(geByClass("feed_row_unshown",e,"div"),(function(){replaceClass(this,"feed_row_unshown","feed_row")}))},updateTitle:function(){cur.idleManager&&(cur.idleManager.isIdle||(cur.feedUnreadCount=0),setDocumentTitle((cur.feedUnreadCount?"("+cur.feedUnreadCount+") ":"")+cur.feedInitialTitle))},toggleTabsMenuTab:function(e,t){var o=geByClass1("feed_section_"+e,cur.feedEls.rmenu);o&&toggleClass(o,"ui_rmenu_item_hidden",!t)},toggleTabsMenu:function(e,t){var o=ge("feed_add_list_icon");return void 0===t&&(t=!hasClass(o,"shown")),browser.mozilla&&setStyle("page_body",{overflow:t?"visible":""}),uiActionsMenu.toggle(o,t),t&&addEvent(document,"mousedown",(function e(t){R.toggleTabsMenu(!1,0),removeEvent(document,"mousedown",e)})),e&&cancelEvent(e)},checkTabsFilter:function(e,t){switch(t){case"news":return!1;case"newlist":return R.addList();default:if(r=t.match(/list(\d+)/))return R.editList(r[1])}var o,s,r,i=t==cur.section,n=cur.my_feed_types.tabs;o=-1!=(s=indexOf(n,t)),toggleClass(e,"checked",!o),o?(n.splice(s,1),i&&(cur.onSaveTabs=function(e,t){R.toggleTabsMenu(null,!1),R.switchSection("news")}.pbind(t,o))):n.push(t),cur.my_feed_types.tabs=n,R.toggleTabsMenuTab(t,!o||i),uiRightMenu.fixScroller(ge("ui_rmenu_"+cur.section+(cur.list||""))),clearTimeout(cur.saveTabsTO),cur.saveTabsTO=setTimeout(R.saveTabs,500)},hasSearchParams:function(e){var t=!1;return each(e,(function(e,o){if((!e.indexOf("c[")&&"c[section]"!==e||"q"==e)&&o)return t=!0,!1})),t},getSectionParams:function(e){var t={section:e};switch(e){case"news":case"recommended":case"groups":case"friends":case"videos":case"photos":case"podcasts":void 0===(t.subsection=cur.subsections[e])&&delete t.subsection;break;case"owner":(t.owner=cur.owner)||delete t.section;break;case"source":(t.source=cur.source)||delete t.source;break;case"list":void 0===(t.subsection=cur.subsections["list"+cur.list])&&delete t.subsection,(t.list=cur.list)||delete t.list;break;case"notifications":(t.source=cur.source)||delete t.source;break;case"articles":void 0===(t.subsection=cur.subsections[e])&&delete t.subsection;break;case"search":var o=ge("search_filters_form");if(o){var s=Object(_.serializeForm)(o)||{};for(var r in s)s[r]&&"0"!=s[r]||delete s[r];extend(t,s)}t["c[q]"]=trim(val(cur.feedEls.search));break;case"photos_search":(t.q=trim(val(cur.feedEls.search)))||delete t.section,(t.sort=intval(cur.search_sort_value))||delete t.sort;break;case"articles_search":(t.q=trim(val(cur.feedEls.search)))||(t.section="articles");break;case"comments":cur.reposts&&(t.reposts=cur.reposts);break;case"mentions":var i=new URLSearchParams(location.search);i.delete("ref"),history.replaceState(null,"","?"+i+location.hash),cur.mentionObj&&cur.mentionObj!=vk.id&&(t.obj=cur.mentionObj)}return t},switchNotifyList:function(e,t){uiRightMenu.go(geByClass1("feed_section_"+e),!1,!1),R.go(t)},switchSubSection:function(e,t,o){if(t&&checkEvent(t))return!0;var s=cur.section;"list"===cur.section&&(s="list"+cur.list),cur.subsection=cur.subsections[s]=e;var r=R.getSectionParams(cur.section);r.hash=o,delete cur.feedUpdateLoading,delete cur.isFeedLoading,nav.go(extend(r||{},{0:"feed"})),uiRightMenu.showProgress(cur.feedEls.rmenu)},switchSection:function(e,t,o){if(t&&checkEvent(t))return!0;if(removeClass(cur.feedEls.wrap,"feed_has_new"),cur.newPostsCount=0,"photos_search"==e&&!trim(val(cur.feedEls.search))){if("photos_search"!=cur.section)return!1;e="photos"}"comments"==e&&(cur.reposts=cur.options.reposts=""),Object(u.statlogsValueEvent)("feed_switch",0,e),R.setSection(e,1);var s=R.getSectionParams(e||"news");delete cur.feedUpdateLoading,delete cur.isFeedLoading;var r=!o&&extend(s||{},{0:"feed"});return uiRightMenu.go(geByClass1("feed_section_"+e),!1,r),!1},setSection:function(e,t,o){if(t=t||0,cur.prevSection=cur.section,!(e==cur.section&&t<2)&&e){if(uiRightMenu.hideProgress(cur.feedEls.rmenu),cur.feedEls.search&&uiSearch.hideProgress(cur.feedEls.search),t>1){Page.playVkFestBanner&&Page.playVkFestBanner(),toggleClass(cur.feedEls.wrap,"feed_submit_shown",inArray(e,cur.options.feed_types.tabs.concat(["list","likes"]))),toggleClass(cur.feedEls.wrap,"feed_submit_only_shown",~["recommended","search","updates","comments"].indexOf(e));var s=inArray(e,["articles_search","articles","search","photos_search","photos"]);toggleClass(cur.feedEls.wrap,"feed_search_shown",s),s&&elfocus(cur.feedEls.search),"search"===e&&o.stories_block_show?addClass(cur.feedEls.wrap,"feed_submit_shown_stories"):removeClass(cur.feedEls.wrap,"feed_submit_shown_stories"),cur.section&&val(cur.feedEls.search,"")}2==t&&window.Stories&&Stories.updateFeedStories(e,o),cur.my_feed_types&&(~indexOf(cur.my_feed_types.optional_tabs,cur.section)&&!~indexOf(cur.my_feed_types.tabs,cur.section)&&R.toggleTabsMenuTab(cur.section,!1),~indexOf(cur.my_feed_types.optional_tabs,e)&&!~indexOf(cur.my_feed_types.tabs,e)&&R.toggleTabsMenuTab(e,!0)),cur.section=e,4!=t?(cur.editingHide=("notifications"==e||"replies"==e)&&R.notifyCheckHideReply,cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler()):R.searchUpdate()}},applyOptions:function(e,t){t=t||0,e.no_left_ads&&(cur.no_left_ads=!0),e.owner&&(cur.owner=e.owner),cur.subsection=e.subsection||"",R.setSection(e.section,t,e),cur.options||(cur.options={reply_names:{}}),extend(cur.options.reply_names,e.reply_names),delete e.reply_names,extend(cur,e);var o=cur.section;if("list"===cur.section&&(o="list"+e.list),cur.subsections[o]=cur.subsection,e.loc&&2==t&&nav.setLoc(e.loc),e.section&&"news"==e.section&&e.subsection&&"top"==e.subsection&&Object(u.statlogsValueEvent)("feed_switch",0,"top_news",t),void 0!==e.filters){var s=ge("search_filters_minimized"),r=s&&hasClass(s,"ui_rmenu_item_expanded"),n=!!s;val("feed_filters",e.filters),window.searcher&&n&&p.searcher.toggleMinimizedFilters(ge("search_filters_minimized"),r,!0)}if(e.script&&Object(i.evalWithLogging)(e.script),e.htitle&&(cur.feedInitialTitle=document.title=replaceEntities(stripHTML(e.htitle))),void 0!==e.add_feed_queue&&null!==e.add_feed_queue?(cur.add_feed_queue=!1,e.add_feed_queue=!1,R.getNewQKey(0),!0!==e.add_queue&&(cur.add_queue=e.add_queue)&&setTimeout(R.update.pbind(0),0)):t&&"search"!=cur.section&&"news"!=cur.section&&cur.section&&(cur.add_feed_queue=!1,e.add_feed_queue=!1),e.add_queues&&(cur.add_queues=e.add_queues,setTimeout(R.update.pbind(0),0)),e.q){val(cur.feedEls.search,replaceEntities(e.q));var a=e.q;a.length>30&&(a=trim(a.substr(0,30))+"...")}e.last_view&&(cur.options.last_view=e.last_view),void 0!==e.feedback_list&&(cur.options.feedback_list=e.feedback_list),R.searchUpdate(),"comments"!=cur.section||cur.reposts||toggle("comments_filters",!cur.reposts),isString(cur.all_shown_text)&&val("all_shown",cur.all_shown_text),isString(cur.show_more_text)&&val("show_more_link",cur.show_more_text),cur.empty_text&&val("feed_empty",cur.empty_text),cur.count>=0&&re("feed_error_wrap");var c=!(geByClass1("feed_row",cur.rowsCont,"div")||!1),l=ge("feed_rows_next");if(c?(toggleClass(cur.feedEls.wrap,"feed_is_empty",!isVisible("feed_error_wrap")),hide("all_shown"),toggle("show_more_link",cur.count>0&&!cur.all_shown)):!cur.all_shown||l&&l.firstChild?(hide("all_shown"),show("show_more_link"),removeClass(cur.feedEls.wrap,"feed_is_empty")):(hide("show_more_link"),show("all_shown"),removeClass(cur.feedEls.wrap,"feed_is_empty"),re(l)),e.playlistsData&&(e.playlistsData=JSON.parse(e.playlistsData),cur.pageVideosList=extend(cur.pageVideosList||{},e.playlistsData)),("notifications"==cur.section||"replies"==cur.section)&&cur.notify){var d=ge("feedback_row"+cur.notify);d&&d.onclick&&(setTimeout((function(){d.onclick(),scrollToY(getXY(d)[1],0)}),browser.msie?100:0),delete cur.notify)}cur.feedSection&&cur.feedSection(e.section,e.subsection),e.hot_feature_tooltip&&setTimeout((function(){R.showHotTooltip(e.hot_feature_tooltip_hash)}),800)},showMore:function(){if(!cur.isFeedLoading){cur.disableAutoMore=!1;var e,t=ge("feed_rows_next");if(t){if(t.firstChild)for(;t.firstChild;)e=t.firstChild,cur.rowsCont!==domPN(t)&&R.sendInsertBeforeError(),cur.rowsCont.insertBefore(e,t),R.onPostLoaded(e,!0);re(t)}"live"==cur.section&&(cur.all_shown=!0);var o=ge("show_more_link");if(cur.all_shown&&(hide(o),show("all_shown")),"live"!=cur.section){var s=!1,r=function(e){e.keyCode==KEY.ESC&&(s=!0)};addEvent(document,"keyup",r);var i=R.getSectionParams(cur.section||"news");extend(i,{offset:cur.offset,from:cur.from,part:1,more:1,last_view:cur.options.last_view}),extend(i,cur.navParams),cur.options.feedback_list&&(i.list=cur.options.feedback_list),nav.objLoc.situational_suggest_id&&(i.situational_suggest_id=nav.objLoc.situational_suggest_id);var n=cur.section;ajax.post("al_feed.php?sm_"+cur.section,i,{onDone:function(e,t){if(removeEvent(document,"keyup",r),n==cur.section)if(s)cur.disableAutoMore=!0;else{if(t){var o,i=ce("div");for(i.innerHTML=t;o=i.firstChild;)o.firstChild&&o.firstChild.id&&!ge(o.firstChild.id)||"feedback_unread_bar"==o.id||hasClass(o,"feed_row_fb_hidden")||hasClass(o,"feed_to_recomm")?(cur.rowsCont.appendChild(o),R.onPostLoaded(o,!0)):i.removeChild(o)}shortCurrency(),R.applyOptions(e),setTimeout(R.scrollCheck,200)}},showProgress:function(){Object(a.lockButton)(o),cur.isFeedLoading=!0},hideProgress:function(){if(Object(a.unlockButton)(o),cur.isFeedLoading=!1,o.seen){var e=Math.ceil((Date.now()-o.seen)/1e3),t=cur.section+(cur.subsection?"_"+cur.subsection:"");Object(u.statlogsValueEvent)("feed_load_more_seen_time",e,t),o.seen=!1}},cache:1})}}},showMoreFriends:function(e,t){checkEvent(t)||(Object(a.lockButton)(e),cur._back.show.push((function(){Object(a.unlockButton)(e)})),nav.go("/friends?act=find"))},showMorePublics:function(e,t){checkEvent(t)||(Object(a.lockButton)(e),cur._back.show.push((function(){Object(a.unlockButton)(e)})),nav.go("/groups?act=catalog&c%5Bcategory%5D=0 "))},getTypesSection:function(){switch(cur.section){case"owner":return cur.owner>0?"person":"group";default:return cur.section}},checkFilter:function(e,t){var o,s=R.getTypesSection(),r=cur.my_feed_types[s],i=cur.feed_types[s];"notifications"!=s?(!0===r&&(r=clone(i)),-1!=(o=indexOf(r,t))?r.splice(o,1):(r.push(t),r.length==i.length&&(r=!0)),checkbox(e),cur.my_feed_types[s]=r,R.updateTypesCookie(),R.setFiltersUpdatePage(),cur.feedEls.rmenu&&uiRightMenu.showProgress(cur.feedEls.rmenu)):R.setNotifyFilter(e,t)},setFilter:function(e,t){var o=R.getTypesSection(),s=ge(o+"_type_filter"),r=!0;"notifications"!=o&&(each(geByClass("_feed_filter_row",s,"div"),(function(){if(isChecked(this)&&this!=e)return r=!1})),r?(cur.my_feed_types[o]=!0,each(geByClass("_feed_filter_row",s,"div"),(function(){checkbox(this,!0)}))):(each(geByClass("_feed_filter_row",s,"div"),(function(){checkbox(this,!1)})),cur.my_feed_types[o]=[t],checkbox(e,!0)),R.updateTypesCookie(),R.setFiltersUpdatePage({force_expand_filters:1}),cur.feedEls.rmenu&&uiRightMenu.showProgress(cur.feedEls.rmenu))},setFiltersUpdatePage:function(e){e=e||{};var t=nav.strLoc;if("updates"===cur.section){t.match(/\&filters\_expanded\=1/)||ge("updates_show_all_filters")&&!e.force_expand_filters||(t+="&filters_expanded=1"),t=t.replace(/\&filters\_shown\=([a-z\,]+)/,"");for(var o=geByClass("_feed_filter_row","feed_filters"),s=[],r=0;r<o.length;r++)hasClass(o[r],"hide")||s.push(o[r].id.replace("filter_updates",""));t+="&filters_shown="+s.join(",")}nav.go(t)},setNotifyFilter:function(e,t){checkbox(e),cur.notifyPrefs||(cur.notifyPrefs={}),cur.notifyPrefs[t]=isChecked(e),clearTimeout(cur.saveNotifyPrefsTO),cur.saveNotifyPrefsTO=setTimeout((function(){var e=[];each(cur.notifyPrefs,(function(t,o){e.push((o?"":"-")+t)})),e=e.join(","),ajax.post("/al_feed.php",{act:"a_set_notify_prefs",prefs:e,feed:1,hash:cur.topNotifyHash},{onDone:function(e){addTemplates({top_notify_prefs:e}),toggleClass("top_notify_pref_"+t,"checked",cur.notifyPrefs[t]),cur.notifyPrefs={},window.TopNotifier&&TopNotifier.invalidate(),nav.go(nav.strLoc),cur.feedEls.rmenu&&uiRightMenu.showProgress(cur.feedEls.rmenu)}})}),500)},updateTypesCookie:function(){var e=[];each(cur.my_feed_types,(function(t,o){"tabs"!=t&&e.push(!0===o?"*":o.join(","))})),setCookie("remixfeed",e.join("."),365)},toggleFeedTop:function(e,t,o){var s=geByClass1("_ui_toggler",e),r="top";switch(toggleClass(s,"on"),cur.section){case"news":case"recommended":case"groups":case"friends":case"videos":case"photos":case"list":r=hasClass(s,"on")?"top":"recent";break;case"articles":r=hasClass(s,"on")?"suggested":"top";break;case"podcasts":r=hasClass(s,"on")?"recent":"top"}R.switchSubSection(r,t,o)},switchList:function(e){cur.prevList=cur.list,cur.list=e,R.setSection("list",1),uiRightMenu.go(geByClass1("feed_section_list"+e),!1,!1),R.go(R.getSectionParams(cur.section))},setSearchSort:function(e){cur.search_sort_value=e,R.submitSearch()},_activateReplyBox:function(e,t,o){(t||{}).cancelBubble=!0;var s=ge("reply_box"+e);if(cur.editing&&cur.editing!=e&&cur.notifyReplyData&&cur.notifyReplyData[cur.editing].disabled&&R.notifyCheckHideReply(cur.editing,(window.event||{}).target),s&&isVisible(s))R.notifyCheckHideReply(e,!1);else if(void 0===cur.notifyReplyData&&(cur.notifyReplyData={}),cur.notifyReplyData[e]=o,o.disabled){s?show(s):ge("feedback_row"+e).appendChild(se(rs(cur.options.feedback_dis,{item:e,text:o.disabled}))),setTimeout((function(){cur.editing=e}),0)}else{show(s),Wall.showEditReply(e,t);var i=ge("reply_field"+e);i.setAttribute("placeholder",o.ph),window.Emoji&&Emoji.val(i,o.greet.replace(/ $/,"&nbsp;")),Object(r.data)(i,"send",R.notifySendReply),removeClass("reply_box"+e,"clear_fix")}},notifyClick:function(e,t,o){var s=ge("feedback_row"+e);Wall.checkPostClick(s,t)&&R._activateReplyBox(e,t,o)},blindNotifyReply:function(e,t,o){R._activateReplyBox(e,t,o)},notifySendReply:function(e,t,o){var s=cur.notifyReplyData[e];if(s&&!s.sending){var i,n=ge("reply_field"+e),c=ge("reply_button"+e),l=ge("feedback_row"+e),d=n&&Object(r.data)(n,"composer");if(o.stickerId)i={message:"",attach1_type:"sticker",attach1:o.stickerId};else{if((i=d?Composer.getSendParams(d,R.notifySendReply.pbind(e)):{message:trim(Emoji.editableVal(n))}).delayed)return;if(!i.attach1_type&&(!i.message||s.greet&&!s.greet.indexOf(i.message)))return void Emoji.editableFocus(n,!1,!0)}extend(i,{act:"post",from:"feedback",item:e},s.params||{});var u=ge("reply_as_group"+e);u&&isVisible(domPN(u))&&(i.from_oid=domData(domClosest("_submit_post_box",u),"from-oid")),s.sending=1,ajax.post("al_wall.php",Wall.fixPostParams(i),{onDone:function(t,o){if(delete s.sending,d?Composer.reset(d):window.Emoji&&Emoji.val(n,""),n.autosize&&n.autosize.update(),R.notifyHideReply(e),o){var r=geByClass1("_answer_wrap",l);val(r,o),show(r)}else t&&showDoneBox(t)},onFail:function(){delete s.sending},showProgress:a.lockButton.pbind(c),hideProgress:a.unlockButton.pbind(c)})}},notifyCheckHideReply:function(e,t){var o=cur.notifyReplyData&&cur.notifyReplyData[e];if(o&&!o.sending&&isVisible("reply_box"+e)){if(cur.editing=!1,!o.disabled){var s=ge("reply_field"+e),r=trim(window.Emoji?Emoji.editableVal(s):""),i=Wall.hasComposerMedia(s);if(!s||i||r&&!o.greet||o.greet.indexOf(r))return}R.notifyHideReply(e)}},notifyHideReply:function(e){cur.editing==e&&(cur.editing=!1);var t=ge("feedback_row"+e);removeClass(t,"reply_box_open"),hide("reply_box"+e);var o=cur.replySubmitSettings;o&&o.tt&&o.tt.el&&o.tt.destroy()},notifyPostTooltip:function(e,t,o,s){var r=(o||{}).reply,i="al_wall.php";t.indexOf("topic_comment")?t=t.replace("wall_reply","").replace("wall",""):(i="al_board.php",t=t.replace("topic_comment","")),s=s||{},Object(l.showTooltip)(e,extend({url:i,params:extend({act:"post_tt",post:t,self:1,from:"feedback"},o||{}),slide:15,shift:[!r||r%2?27:329,6],ajaxdt:100,showdt:400,hidedt:800,dir:"auto",className:"rich wall_tt wall_module _feed_notification feed_notification",appendParentCls:"scroll_fix_wrap"},s))},sendInsertBeforeError:function(){ajax.post("al_page.php",{act:"insert_before_error",trace:(new Error).stack,owner_id:cur.oid,module:cur.module})},getModuleRef:function(){var e=cur.module||"feed_other";return"feed"==cur.module&&(e="news"==cur.section?cur.subsection?"feed_news_"+cur.subsection:"feed_news":"podcasts"===cur.section?e+"_"+cur.section+("recent"===cur.subsection?"_my":""):cur.section?e+"_"+cur.section:"feed_other"),e},ignoreItem:function(e,t,o,s,r){var n="block_market-items"===e?ge(e):ge("post"+e);if(n){var a=n.getAttribute("data-ad"),c=geByClass1("ui_actions_menu_wrap",n),l=R.getModuleRef();c&&uiActionsMenu.toggle(c,!1),revertLastInlineVideo(n),cur.feedEntriesHTML[e]=val(n),ajax.post("/al_feed.php?misc",{act:"a_ignore_item",post_raw:e,feed_raw:t,caption_type:s,uids:r,hash:o,ad_data:a,ref:l,session_id:cur.feed_session_id,module:R.getModuleRef(),position:indexOf(domPN(domPN(n)).children,domPN(n))},{onDone:function(e,t){val(n,e),Object(i.evalWithLogging)(t)},stat:[jsc("web/privacy.js"),"privacy.css"]})}},unignoreItem:function(e,t,o,s){var r=R.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_unignore_item",post_raw:e,feed_raw:t,hash:o,ref:r},{onDone:function(){R.restorePost(e)},showProgress:s&&a.lockButton.pbind(s),hideProgress:s&&a.unlockButton.pbind(s)})},reportIgnoredItem:function(e,t){ajax.post("al_wall.php",{act:"spam",post:e,hash:t},{onDone:function(t){var o=ge("post"+e),s=o&&geByClass1("feed_post_report",o,"div");val(s,t)}})},ignoreOwner:function(e,t,o,s,r){e&&(cur.feedEntriesHTML[e+"_ignored"]=val("post"+e));var i="list"==cur.section&&cur.list||0,n=R.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_ignore_owner",post_raw:e,owner_id:t,type:o,hash:s,list:i,ref:n},{onDone:function(o){val("post"+e,o),each(geByClass("post",cur.rowsCont),(function(o,s){var r=this.id.match(/post((-?\d+)_(-?\d+)(_\d+)?)/);r&&r[1]!=e&&(!r[4]&&r[2]==t||r[4]&&r[3]==t)&&(revertLastInlineVideo(this),hide(this.parentNode))}))},showProgress:r&&a.lockButton.pbind(r),hideProgress:r&&a.unlockButton.pbind(r)})},unignoreOwner:function(e,t,o,s){var r="list"==cur.section&&cur.list||0,i=R.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_unignore_owner",post_raw:e||"",owner_id:t,hash:o,list:r,ref:i},{onDone:function(o){e?val("post"+e,cur.feedEntriesHTML[e+"_ignored"]):val("ignore_row"+t,o),each(geByClass("post",cur.rowsCont),(function(e,o){var s=this.id.match(/post((-?\d+)_(-?\d+)(_\d+)?)/);s&&(!s[4]&&s[2]==t||s[4]&&s[3]==t)&&show(this.parentNode)}))},showProgress:s&&a.lockButton.pbind(s),hideProgress:s&&a.unlockButton.pbind(s)})},ignoreGroupWall:function(e,t,o,s){e&&(cur.feedEntriesHTML[e+"_ignored"]=val("post"+e));var r=R.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_ignore_owner",post_raw:e,owner_id:t,ignore_type:"group_wall",hash:o,ref:r},{onDone:function(t){val("post"+e,t)},showProgress:s&&a.lockButton.pbind(s),hideProgress:s&&a.unlockButton.pbind(s)})},unignoreGroupWall:function(e,t,o,s){var r=R.getModuleRef();ajax.post("/al_feed.php?misc",{act:"a_unignore_owner",post_raw:e||"",owner_id:t,ignore_type:"group_wall",hash:o,ref:r},{onDone:function(o){e?val("post"+e,cur.feedEntriesHTML[e+"_ignored"]):val("ignore_row"+t,o)},showProgress:s&&a.lockButton.pbind(s),hideProgress:s&&a.unlockButton.pbind(s)})},ignoreLiveOwner:function(e,t,o,s){var r=ge("post"+e),i=geByClass1("ui_actions_menu_wrap",r);i&&uiActionsMenu.toggle(i,!1),revertLastInlineVideo(r),cur.feedEntriesHTML[e+"_ignored"]=val("post"+e),ajax.post("al_feed.php?act=a_ignore_live_owner",{post_raw:e,owner_id:t,hash:o},{onDone:function(t){val("post"+e,t)},showProgress:s&&a.lockButton.pbind(s),hideProgress:s&&a.unlockButton.pbind(s)})},unignoreLiveOwner:function(e,t,o,s){ajax.post("al_feed.php?act=a_unignore_live_owner",{post_raw:e,owner_id:t,hash:o},{onDone:function(t){val("post"+e,cur.feedEntriesHTML[e+"_ignored"])},showProgress:s&&a.lockButton.pbind(s),hideProgress:s&&a.unlockButton.pbind(s)})},unsubscribe:function(e,t,o){triggerEvent(ge("post_delete"+e),"mouseout"),cur.feedEntriesHTML[e]=ge("post"+e).innerHTML;var s=e.match(/(\-?\d+)_(photo|video|topic|note|market|)(\d+)/);s&&ajax.post("al_feed.php",{act:"unsubscribe",type:{"":24,photo:21,video:22,topic:20,note:23,market:25}[s[2]],owner_id:s[1],place_id:s[3],hash:t,feed:1},{onDone:function(t){ge("post"+e).innerHTML=t.replace("%post_raw%",e)},showProgress:o&&a.lockButton.pbind(o),hideProgress:o&&a.unlockButton.pbind(o)})},subscribe:function(e,t,o){var s=e.match(/(\-?\d+)_(photo|video|topic|note|market|)(\d+)/);s&&ajax.post("al_feed.php",{act:"subscribe",type:{"":24,photo:21,video:22,topic:20,note:23,market:25}[s[2]],owner_id:s[1],place_id:s[3],hash:t,feed:1},{onDone:R.restorePost.pbind(e),showProgress:o&&a.lockButton.pbind(o),hideProgress:o&&a.unlockButton.pbind(o)})},restorePost:function(e){var t="block_market-items"===e?ge(e):ge("post"+e);t.innerHTML=cur.feedEntriesHTML[e];var o=geByClass1("input_back",t,"div"),s=geByTag1("textarea",t);s&&(s.placeholder=o.innerHTML,o.parentNode.removeChild(o),Object(n.placeholderSetup)(s))},toggleReposts:function(e,t,o,s){if(checkEvent(s))return!0;var r=ge("feed_reposts_more"+t+"_"+o),i=ge("feed_reposts"+t+"_"+o),n=0,a=scrollGetY(),c=isVisible(i);if(i)return c?n-=i.offsetHeight+intval(getStyle(e,"marginTop")):(domPN(domPN(i))||{}).bits=0,toggle(i,!c),val(r,c?getLang("news_show_X_reposts",i.childNodes.length):getLang("news_hide_reposts")),n&&scrollToY(a+n+getSize("page_header")[1],0),!1;r&&re(r.parentNode.parentNode)},editHidden:function(){return showTabbedBox("al_settings.php",{act:"a_edit_owners_list",list:"feed",height:lastWindowHeight},{stat:["ui_controls.js","ui_controls.css",jsc("web/indexer.js")]}),cur.onOListSave=R.onHiddenSave,!1},onHiddenSave:function(e,t,o,s){var r=curBox(),i={act:"a_ignore_olist",no_reposts:ge("feed_list_reposts")&&!isChecked("feed_list_reposts")?1:0,hash:s.hash};return e.length<t.length?i.White=e.join(","):i.Black=t.join(","),ajax.post("al_feed.php",i,{onDone:function(e,t){r.hide(),R.switchSection("photos"==cur.section?"photos":"news")},showProgress:a.lockButton.pbind(r.btns.ok[0]),hideProgress:a.unlockButton.pbind(r.btns.ok[0])}),!1},addList:function(){return R.editList(-1)},editList:function(e){return R.toggleTabsMenu(!1,0),showTabbedBox("al_settings.php",{act:"a_edit_owners_list",list:"feed",list_id:e,height:lastWindowHeight},{stat:["ui_controls.js","ui_controls.css",jsc("web/indexer.js")],onFail:function(e){return setTimeout(Object(c.showFastBox)({title:getLang("global_error"),bodyStyle:"padding: 20px; line-height: 160%;"},e,getLang("global_close")).hide,4500),!0}}),cur.onOListSave=R.onListSave.pbind(e),!1},onListSave:function(e,t,o,s,r){var i=val("feed_list_name");if(!trim(i))return Object(a.notaBene)("feed_list_name"),!1;if(!t.length)return!1;var n=curBox();return ajax.post("al_feed.php",{act:"a_save_list",hash:cur.tabs_hash,White:t.join(","),title:i,list_id:e,no_reposts:ge("feed_list_reposts")&&!isChecked("feed_list_reposts")?1:0},{onDone:function(t){var o=geByClass1("feed_section_list"+e,cur.feedEls.rmenu),s=geByClass1("feed_filter_list"+e,cur.feedEls.rmenu);val(o,clean(i)),val(geByClass1("ui_actions_menu_item_label",s),clean(i)),n.hide(),e>0?R.switchList(e):nav.go({0:"feed",section:"list",list:t},null,{nocur:!0})},onFail:function(e){return val("feed_list_error",e),show("feed_list_error_wrap"),!0},showProgress:a.lockButton.pbind(n.btns.ok[0]),hideProgress:a.unlockButton.pbind(n.btns.ok[0])}),!1},deleteList:function(e,t,o,s){if(s&&cancelEvent(s),e<=0)return!1;if(o){var r=curBox();ajax.post("al_feed.php",extend({act:"a_delete_list",list_id:e,hash:cur.tabs_hash}),{onDone:function(){re(geByClass1("feed_section_list"+e,cur.feedEls.rmenu)),re(geByClass1("feed_filter_list"+e,cur.feedEls.rmenu)),boxQueue.hideAll(),"list"==cur.section&&cur.list==e&&R.switchSection("news")},showProgress:a.lockButton.pbind(r.btns.ok[0]),hideProgress:a.unlockButton.pbind(r.btns.ok[0])})}else{R.toggleTabsMenu(!1,0);var i=Object(c.showFastBox)({title:getLang("news_delete_list_sure_title"),bodyStyle:"padding: 20px; line-height: 160%;"},getLang("news_delete_list_sure").replace("{list}",t),getLang("global_delete"),(function(){R.deleteList(e,t,!0)}),getLang("global_cancel"),(function(){i.hide()}))}},saveTabs:function(){ajax.post("al_feed.php",{act:"a_save_tabs",hash:cur.tabs_hash,tabs:cur.my_feed_types.tabs.join(",")},{hideProgress:function(){Object(g.isFunction)(cur.onSaveTabs)&&cur.onSaveTabs(),cur.onSaveTabs=null}})},statsShow:function(e,t){return showWiki({w:"stats"+(cur.source||"")},!1,e)},editLiveBlacklist:function(e){cancelEvent(e),showBox("al_video.php?act=live_blacklist_box",{},{onDone:function(e,t){v.default.init(e,t)},stat:["videoview.js","videoview.css",jsc("web/indexer.js")]})},scrollCheck:Object(h.debounce)((function(e){if("scroll"==(e=e||{}).type||cur.idleManager&&!cur.idleManager.isIdle){var t,o,i,n,c,l,d=window.innerHeight||document.documentElement.clientHeight||bodyNode.clientHeight,_=scrollGetY(),p=0,h=[];if(cur.isFeedLoading||cur.disableAutoMore||(n=ge("show_more_link"),isVisible(n)&&_+d+1e3>n.offsetTop&&R.showMore()),domPN(cur.topRow)==cur.rowsCont&&"feed_rows_next"!=(cur.topRow||{}).id||(cur.topRow=domFC(cur.rowsCont)),vk.id&&cur.topRow&&"feed_rows_next"!=cur.topRow.id&&(!((window.curNotifier||{}).idle_manager||{}).is_idle||"init"==e.type)){var g=[];for(n=domPS(cur.topRow);n;n=domPS(n))cur.topRow.offsetTop>_&&(cur.topRow=n),n.unseen||(n.unseen=!0,g.push(m(n)));for(Page.postsUnseen(g),n=cur.topRow;n&&!((t=p||n.offsetTop)>=_+d);n=c)if("feed_rows_next"==((c=domNS(n))||{}).id&&(c=null),(p=c?c.offsetTop:t+n.offsetHeight)<_&&c&&(cur.topRow=c),LongView&&LongView.register(n,"feed"),P(n),!((l=n.bits||0)>=3)&&(cur.feedSeenPostHeight>0?(cur.feedPostHeaderHeight=cur.feedPostHeaderHeight||Object(r.getH)(geByClass1("post_header",n)),i=(o=t+cur.feedPostHeaderHeight)+cur.feedSeenPostHeight,n.postBottom||(n.postBottom=o+Object(r.getH)(geByClass1("wall_text",n))),l|=(o>=_&&o<_+d?1:0)|((i=Math.min(i,n.postBottom))>=_&&i<_+d?2:0)):l|=(t>=_&&t<_+d?1:0)|(p>=_&&p<_+d?2:0),l&&(n.bits=l,3==l))){var v=m(n);if(b(n)||w(n)?Wall.triggerAdStat(domFC(n),"impression"):h.push(v),hasClass(n,"feed_to_recomm"))Object(u.statlogsValueEvent)("promo_button_view_blocks",v.index,v.module);else if(geByClass1("feed_friends_recomm",n))!function(){var e=geByClass1("ui_gallery",n),t=domData(e,"from"),o=domData(e,"code")||"";Object(f.friendsRecommLogSave)(["view_block",t,v.index,vkNow(),v.module,o],!0);var r=Object(s.uiGetGallery)(e);r&&r.getVisibleItems().forEach((function(e){Object(f.onViewFriendRecomm)(e[0],e[1],t)})),e.visible=!0}();else if(geByClass1("feed_groups_recomm",n)){var y,C=geByClass1("ui_gallery",n),S=domData(C,"code")||"";null===(y=window.RecommendedGroups)||void 0===y||y.viewBlock(S);var x=Object(s.uiGetGallery)(C);x&&x.getVisibleItems().forEach((function(e){var t;null===(t=window.RecommendedGroups)||void 0===t||t.onViewGroup(e[0])})),C.visible=!0}}h=h.concat(k(_,d)),LongView&&LongView.onScroll(_,d),Page.postsSeen(h);var E=ge("show_more_link"),L=E.offsetTop;if(!E.seen&&L>=_&&L<_+d){E.seen=Date.now();var B=cur.section+(cur.subsection?"_"+cur.subsection:"");Object(u.statlogsValueEvent)("feed_load_more_seen",Object(a.isButtonLocked)(E),B)}}}}),20),searchUpdate:function(){var e;cur.feedEls.search&&getLang("news_search")&&(e=cur.section.indexOf("photos")?cur.section.indexOf("articles")?getLang("news_search"):getLang("news_articles_search"):getLang("news_photo_search"),cur.feedEls.search.setAttribute("placeholder",clean(unclean(e))),placeholderInit(cur.feedEls.search,{reload:!0}))},go:function(e,t,o){if(e=e||{},cur._back_local){var s=cur._back_local;s.back?showBackLink(s.back[0],s.back[1],s.back[2]):showBackLink(!1),cur._back_local=!1}if(cur.feedReq)try{cur.feedReq.abort()}catch(e){debugLog(e)}cur.feedReqObj=null;var r=1,n=function(){cur.isFeedLoading=!1};(browser.msie||o)&&(r=!1,n=cur.onFrameBlocksDone),cur.wasScroll=!!o&&scrollGetY();var a=window.event&&window.event.target;if(a&&"search"===e.section&&!e._post){var c=nav.getPostParams(a);if(c.post_id&&c.post_click_type){function l(t,o){t&&!e[o]&&(e[o]=t)}l(c.post_id,"_post"),l(c.post_click_type,"_post_click_type"),l(c.post_click_url,"_post_click_url"),l(c.post_click_mention_id,"_post_click_mention_id"),l(c.post_click_cc_key,"_post_click_cc_key"),l(c.ad_data,"_post_ad_data"),l(c.ad_block_unique_id,"_post_ad_block_unique_id")}}var d=cur.feedReqObj={},_={},f=0,p=()=>{if(cur.feedReqObj&&cur.feedReqObj===d&&!(++f>500)){var e=!0,t={};each(_,(function(o){var s=ge(o);if(s&&hasClass(s,"feed_row"))return s.firstChild?void R.onPostLoaded(s,!0):(t[o]=!0,void(e=!1))})),e||(_=t,setTimeout(p,100))}},h=+new Date;cur.feedReq=ajax.post("al_feed.php",extend(e,{part:1}),{onDone:function(o,s,n,a,c){if(revertLastInlineVideo(),removeClass(cur.feedEls.wrap,"feed_has_new"),cur.newPostsCount=0,window.tooltips&&tooltips.destroyAll(ge("feed_rows")),boxQueue.hideAll(),layers.fullhide&&!cur.storyLayer&&layers.fullhide(!0),r&&ajax._framenext(),window.wall&&Wall.cancelEdit(),boxQueue.hideAll(),t?t(s||""):val(cur.rowsCont,s||""),R.applyOptions(o,2),!e.norecom&&"notifications"!==e.section){val("feed_recommends",o.recommends||""),toggle("feed_recommends",!!o.recommends);var l="/al_feed.php#"+AjaxConvert.toQueryString({act:"recom"});ajaxCache[l]&&delete ajaxCache[l],cur.recomPreload=!1,toggleClass(cur.feedEls.wrap,"feed_asc_shown",geByClass1("feed_asc_block","feed_recommends"))}var d;if(n&&Object(i.evalWithLogging)(n),checkPageBlocks(),scrollToTop(0),shortCurrency(),cur.feedEls.wall)switch(d="clear_fix",cur.section){case"updates":d+=" page_block feed_updates";break;case"photos_search":d+=" page_block feed_found_photos";break;case"notifications":d+=" page_block feed_notifications";break;case"coronavirus":case"stayhome":d+=" feed_wall--with-header"}if(ge("feed_wall").className=d,toggle("feed_recommends",inArray(cur.section,["news","recommended","videos"])),val("feed_app_widget",a||""),toggle("feed_app_widget",a),a&&c&&Object(i.evalWithLogging)(c),cur.rowsCont&&cur.rowsCont.children&&(each(cur.rowsCont.children,(function(){var e=this;hasClass(e,"feed_row")&&(!e.id||e.firstChild?R.onPostLoaded(e,!0):_[e.id]=!0)})),isEmpty(_)||setTimeout(p,10)),cur.q){var f="photos_search"===cur.section?u.servicePhotos:u.serviceNews,g=+new Date-h;Object(u.saveSearchAttemptStats)(f,0,cur.count,val(cur.feedEls.search),0,0,g)}setTimeout(R.scrollCheck,200)},onFail:function(){return!1},showProgress:function(){cur.isFeedLoading=!0},frame:r,ads:1,hideProgress:n})},onFeedSearch:function(e,t,o,s){t||Object(u.removeSearchPositionTracker)("photos");var r,i,n=s||cur.section;if(n.indexOf("photos")?n.indexOf("articles")?(r="search",i="news"):(r="articles_search",i="articles"):(r="photos_search",i="photos"),"search"==r||R.hasSearchParams(R.getSectionParams(r))){r!=cur.section&&R.setSection(r,1);var a=R.getSectionParams(r);cur.disableSort&&(a.disable_sort=1),R.go(a),window.searcher&&p.searcher.highlightHotHashtag(t||val(e))}else R.go(R.getSectionParams(i));uiSearch.onChanged(e),uiSearch.showProgress(e)},onSearchChange:function(){return setTimeout(R.onFeedSearch.pbind(cur.feedEls.search),0),!1},init:function(e){var t,o,s,r;setTimeout((function(){each(geByTag("textarea",cur.rowsCont),(function(){Object(n.placeholderSetup)(this)})),cur.q&&Object(u.saveSearchAttemptStats)("photos_search"===cur.section?u.servicePhotos:u.serviceNews,0,cur.count,val(cur.feedEls.search))}),200),extend(cur,{oid:e.user_id,postTo:e.user_id,phCache:{},phShown:{},subsections:{},feed_session_id:e.feed_session_id||"na",module:"feed",isFeedLoading:!1,customSearchChange:R.onSearchChange,navParams:e.nav_params||{},wallPostCb:function(){"news"==cur.section?setTimeout(R.update.pbind(1),1e3):setTimeout(R.switchSection.pbind("news"),1e3)},idleManager:(r={isIdle:!1,onIdle:null,onUnIdle:null,stop:function(){removeEvent(document,"mousemove keydown",t),removeEvent(window,"focus blur",s)},start:function(){browser.mobile||(t=function(){cur.idleManager&&r.isIdle&&(r.isIdle=!1,r.onUnIdle&&r.onUnIdle())},o=function(){cur.idleManager&&(r.isIdle=!0,r.onIdle&&r.onIdle())},s=function(e){"focus"==e.type?t():o()},addEvent(window,"focus blur",s))}},r),currentModule:function(){return"videos"==cur.section?"feed_videos":cur.module},onFrameBlocksDone:function(){cur.isFeedLoading=!1,(0===cur.wasScroll||cur.wasScroll>0||!1===cur.wasScroll&&"search"==cur.section&&cur.q&&"#"==cur.q.substr(0,1))&&(cur.wasScroll=!1)},feedEntriesHTML:{},feedUnreadCount:0,feedInitialTitle:"",feedUnread:[],feedToSort:[],feedEls:{wrap:ge("main_feed"),wall:ge("feed_wall"),search:ge("search_query"),rmenu:ge("feed_rmenu"),newPosts:ge("feed_new_posts")}}),cur.nav.push((function(e,t,o,s){if(void 0===e[0]){var r=clone(o);if(delete r[0],void 0===e.section||inArray(cur.section,["notifications","replies"])==inArray(e.section,["notifications","replies"])){if("notifications"==cur.section)return R.switchNotifyList(o.list||"all",extend(r,s.params||{})),!1;if(e.list)return R.switchList(e.list),!1;if(void 0!==e.section&&R.switchSection(e.section||"news",!1,!0),e.notify)return!1;if(e.q)return val(cur.feedEls.search,e.q),R.onFeedSearch(cur.feedEls.search),!1;if(delete e.subsection,isEmpty(e)){var i=geByClass1("feed_section_"+(t.section||"news")+(t.list||""));i&&uiRightMenu.go(i,!1,!1)}return cur.likesTabTT&&cur.likesTabTT.destroy(),R.go(extend(r,s.params||{})),!1}}})),cur.idleManager.onUnIdle=R.updateTitle,cur.idleManager.onIdle=R.reSortItems,cur.options=cur.options||{},extend(cur.options,e),R.applyOptions(e,3),cur.rowsCont=e.wallCont=ge("feed_rows"),Wall.init(e),cur.rowsCont&&cur.rowsCont.children&&each(cur.rowsCont.children,(function(){hasClass(this,"feed_row")&&this.firstChild&&R.onPostLoaded(this,!0)})),cur._back={text:getLang("news_return_to_news"),show:[R.startEvents],hide:[function(){clearInterval(cur.updateInt),removeEvent(window,"scroll",R.scrollCheck),removeEvent(window,"resize",R.scrollCheck),cur.idleManager.stop(),clearTimeout(cur.lp_error_to)}],loc:!1},R.startEvents(),Object(f.friendsRecommLogSend)(!0),setTimeout((function(){R.scrollCheck({type:"init"})}),200)},startEvents:function(){cur.idleManager.start(),cur.updateInt=setInterval((function(){R.update(0)}),2e4),addEvent(window,"scroll",R.scrollCheck),addEvent(window,"resize",R.scrollCheck)},mentionClick:function(e,t){var o=e,s=((e.getAttribute("mention")||"").match(/^bp(-?\d+_\d+)$/)||{})[1];if(!s)return nav.go(e,t);for(s=s.split("_");e;e=e.parentNode){var r=(e.id||"").match(/^replies(-?\d+_topic\d+)$/);if(r){if(r[1].split("_")[0]==s[0])return Wall.showReply(o,r[1],s[0]+"topic_"+s[1],t);break}}return nav.go(e,t)},toggleCustomFeedTab:function(e,t){return hasClass(e,"feed_tab_link_hidden")?(removeClass(e,"feed_tab_link_hidden"),setCookie("remixcustom_feed_added",t)):Object(a.lockButton)(e),R.checkTabsFilter(geByClass1("_feed_custom_"+t),t)},recomPreload:function(){cur.recomPreload||(cur.recomPreload=!0,ajax.post("/al_feed.php",{act:"recom",section:cur.section},{cache:1}))},recomMore:function(e){if(!1===checkEvent(e)){var t=ge("feed_recom_rows"),o=ge("feed_recom_more");if(t.childNodes.length>2){for(;t.childNodes.length>2;)t.removeChild(t.lastChild);return scrollToY(0,0),hide(o.firstChild.nextSibling),show(o.firstChild),cancelEvent(e)}return ajax.post("/al_feed.php",{act:"recom",section:cur.section},{cache:1,onDone:function(e){hide(o.firstChild),show(o.firstChild.nextSibling);for(var t,s=ce("div",{innerHTML:e}),r=ge("feed_recom_rows");t=s.firstChild;)ge(t.id)?re(t):r.appendChild(t);r.childNodes.length%2&&re(r.lastChild)},showProgress:function(){hide(o.firstChild),show(o.lastChild)},hideProgress:function(){show(o.firstChild),hide(o.lastChild)}}),cancelEvent(e)}},recomSubscribe:function(e,t,o){var s,r,i=o?t:domPS(t),n=o?domNS(t):t;o?(s="/al_feed.php",r={act:"subscr",oid:e,from:nav.objLoc.section,hash:val("feed_recom_hash")}):(s="/al_fans.php",r={act:"unsub",oid:e,hash:val("feed_recom_hash"),no_response:1}),ajax.post(s,r,{onDone:function(){toggle(i,!o),toggle(n,!!o),"recommended"!=nav.objLoc.section&&nav.go(nav.objLoc,!1,{params:{norecom:1}})},showProgress:a.lockButton.pbind(t),hideProgress:a.unlockButton.pbind(t)})},clickBlogReminder:function(e,t,o,s,r,i){if(ajax.post("blog.php",{act:"click_reminder",hash:s,nid:t,accept:1,target:i},{onDone:function(){}}),"_blank"===!attr(e,"target"))return cancelEvent(r),nav.go(o)},hideBlogReminder:function(e,t,o,s){o&&cancelEvent(o),re("feed_blog_reminder"),ajax.post("blog.php",{act:"hide_reminder",hash:e,nid:t,accept:0,target:s},{onDone:function(){}})},preloadVideos:function(e){function t(e){var t=new XMLHttpRequest;t.open("GET",e),t.send()}e&&cur.videoAutoplayScrollHandler&&(cur.videoAutoplayPreloaded=cur.videoAutoplayPreloaded||{},each(e,(function(e,o){t(o.index_url),t(o.index_url.replace(/index-(.+).m3u8/,"seg-1-$1.ts")),cur.videoAutoplayPreloaded[o.video]=o.quality})))},expandJoinedGroups:function(e,t){return cancelEvent(t),show(geByClass1("feed_groups_hidden_list",e.parentNode)),re(e),!1},showAllFilters:function(e){re(e);for(var t=geByClass("hide",e.parentNode),o=0;o<t.length;o++)removeClass(t[o],"hide")},toggleSubscription:function(e,t,o,s,r){var i=domClosest("_ui_menu_wrap",e);i&&uiActionsMenu.toggle(i,!hasClass(i,"shown")),Page.toggleSubscription(e,t,o,s,r,(function(e,t){geByClass("post",cur.rowsCont).forEach((function(o){var r=o.id.split("_"),i=+r[r.length-2].replace("post","");if(s===i){var n=geByClass1("page_action_subscribe",o);val(n,e),domData(n,"act",t)}}))}))},logBlockInteraction:function(e,t,o){var s=indexOf(domPN(e).children,e);Object(u.statlogsValueEvent)("block_interaction",s,t,o)},showHotTooltip:function(e){var t=geByClass1("hot");t&&(cur.hotFeatureTT=new ElementTooltip(t,{content:'<div class="feature_tooltip__close" onclick="cur.hotFeatureTT.hide();"></div>'+getLang("wall_hot_feature_text"),forceSide:"left",cls:"feature_intro_tt feature_info_tooltip hot_feature_tooltip",autoShow:!1,noHideOnClick:!0,noAutoHideOnWindowClick:!0,appendToParent:!0,offset:[15,0],onHide:function(){ajax.post("al_index.php",{act:"hide_feature_tt",hash:e,type:"hot_web"})}}),cur.hotFeatureTT.show())},onPostLoaded:function(e,t){var o=geByClass1("friends_recomm_gallery",e);o&&Object(f.friendsRecommInit)(o,{checkViewItem:function(){return o.visible},onDestroy:function(){re(e)}}),Wall.onPostLoaded(e,t),this.initPrettyCardGallery(e)},openPostSuggest:function(e,t,o){if(t&&null!=t.type)switch(t.type){case 1:var s=t.postData,r=t.notHideByClick,i=ge("post_field");return void((i?trim(i.innerHTML).replace("<br>",""):"")||cur.wallAddMedia&&cur.wallAddMedia.attachCount()?Object(c.showFastBox)({title:getLang("news_suggest_alert_title"),dark:1},getLang("news_suggest_alert_text"),getLang("global_yes"),(function(){curBox().hide(),n(s,r)}),getLang("global_cancel")):n(s,r));case 4:return window.open(t.link),void R.suggestionEvent(e,"open",o,t.notHideByClick)}function n(t){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];cur.wallAddMedia&&cur.wallAddMedia.unchooseMedia(),cur.options&&(cur.options.situational_suggest_id=e),t[0]=t[0].replace(/<br>/g,"\n");var r=cur.editing;delete cur.editing,Wall.setDraft(t),R.suggestionEvent(e,"open",o,s),cur.editing=r}},suggestionEvent:(e,t,o,s)=>(ajax.post("al_feed.php",{act:"suggestion_event",suggest_id:e,event_type:t,not_hide_by_click:intval(s)}),s||re(geByClass1("_post_suggest")),cancelEvent(o)),closePostSuggest(e,t,o){R.suggestionEvent(e,t,o,!1)},hideRightBlock:function(e,t,o){var s=domCA(e,".page_block");return re(s),ajax.post("al_feed.php",{act:"a_hide_right_block",block_type:t,app_id:e.dataset.app_id||0,hash:o}),!1},initPrettyCardGallery:function(e){if(!geByClass1("pretty-cards",e))return!1;window.PrettyCardGallery&&new PrettyCardGallery(e)},moveToPrevPhotoInPhotoCarousel(e,t){if(t&&!t.classList.contains("PhotoCarousel__arrowWrapper--hidden")){var o=t.closest(".PhotoCarousel");if(o){var s=Number(o.getAttribute("data-idx"))-1;R.sendPhotoCarouselEvent("click_previous",o),R.moveToPhotoInPhotoCarousel(o,s)}}else e.stopPropagation()},moveToNextPhotoInPhotoCarousel(e,t){if(t&&!t.classList.contains("PhotoCarousel__arrowWrapper--hidden")){var o=t.closest(".PhotoCarousel");if(o){var s=Number(o.getAttribute("data-idx"))+1;R.sendPhotoCarouselEvent("click_next",o),R.moveToPhotoInPhotoCarousel(o,s)}}else e.stopPropagation()},moveToPhotoInPhotoCarousel(e,t){var o=e.querySelector(".PhotoCarousel__items"),s=e.querySelectorAll(".PhotoCarousel__item"),r=e.querySelector(".PhotoCarousel__arrowWrapper--left"),i=e.querySelector(".PhotoCarousel__arrowWrapper--right"),n=e.closest(".post_photos"),a=Number(e.getAttribute("data-idx")),c=s[t],l=s[a],d=c.getAttribute("data-photo-raw-id");if(c){var u=M(getSize(o),1)[0],_=M(getSize(e),1)[0],f=M(getSize(c),1)[0],p=c.offsetLeft,h=Math.round(u-_),g=p+f/2-_/2;if(t>a)g=Math.min(g,h);else{if(!(t<a))return;g=Math.max(g,0)}g=Math.round(g),o.style.transform=`translateX(-${g}px)`;var v=(_-f-12)/2,m=_-f-20-6;g?(r.classList.remove("PhotoCarousel__arrowWrapper--hidden"),r.style.width=g===h?m+"px":v+"px"):r.classList.add("PhotoCarousel__arrowWrapper--hidden"),g===h?i.classList.add("PhotoCarousel__arrowWrapper--hidden"):(i.classList.remove("PhotoCarousel__arrowWrapper--hidden"),i.style.width=g?v+"px":m+"px"),l.classList.remove("PhotoCarousel__item--active"),c.classList.add("PhotoCarousel__item--active"),Array.from(s).slice(t,t+4).forEach(e=>{var t=e.getAttribute("data-photo-url");t&&(e.querySelector(".PhotoCarousel__photo").style.backgroundImage=`url('${t}')`,e.removeAttribute("data-photo-url"))}),e.setAttribute("data-idx",t),n.setAttribute("data-photo-raw-id",d)}},photoCarouselLikeClick(e,t,o,s){var r=t.target.closest(".post_photos");if(r){var i="like";e.classList.contains("active")&&(i="unlike"),R.sendPhotoCarouselEvent(i,null,r),Likes.toggle(e,t,o,s)}},photoCarouselCommentClick(e,t,o,s){var r=s.target.closest(".post_photos");r&&(R.sendPhotoCarouselEvent("click_to_comment",null,r),Object(S.showPhoto)(e,t,o,s),cancelEvent(s))},photoCarouselShareClick(e,t,o){var s=o.target.closest(".post_photos");s&&(R.sendPhotoCarouselEvent("click_to_sharing",null,s),cur.sbOnShare=()=>{R.sendPhotoCarouselEvent("repost",null,s)},Likes.share(e,t),cancelEvent(o))},photoCarouselPostClick(e,t){t.target.classList.contains("post_img")||t.target.classList.contains("author")||t.target.classList.contains("mem_link")||t.target.classList.contains("PhotoCarousel__avatar")?R.sendPhotoCarouselEvent("open_user",null,e):t.target.classList.contains("PhotoCarousel__photo")||t.target.classList.contains("page_post_thumb_wrap")?R.sendPhotoCarouselEvent("open_photo",null,e,t):t.target.classList.contains("PhotoCarousel__hidePost")&&R.sendPhotoCarouselEvent("hide",null,e)},sendPhotoCarouselEvent(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(o||t){o||(o=t.closest(".post_photos"));var r=o.querySelector(".post_img"),i=r&&r.getAttribute("data-post-id");if(i){var n,a,c=i.match(/(-?\d+)_p(\d+)/);if(c&&c[1]&&c[2]){n=c[1],a=c[2];var l=o.getAttribute("data-photo-raw-id"),d=o.getAttribute("data-pseudopost-type"),_=o.getAttribute("data-post-creation-timestamp");if(!l&&"photo_group"===d&&s){var f=s.target;if(f&&f.href){var p=f.href.match(/\/photo(-?\d+_\d+)/);l=p&&p[1]}}var h={event_type:e,content_type:d,post_owner_id:n,post_id:a,photo_raw_id:l,timestamp:_,ref:R.getModuleRef()};Object(u.statlogsValueEvent)("feed_new_carousel_stat",h)}}}},showMarketItem(e,t,o,s){j.showItem(e,t,o,s)},showAllMarketItems(e,t,o){j.showAll(e,t,o)},logMarketItemsBlockClick(e,t,o,s){j.logClick(e,t,o,s)}};window.feed=R,window.Feed=R;try{stManager.done(jsc("web/feed.js"))}catch(e){}},zuld:function(e,t,o){"use strict";o.r(t);o("rGqo"),o("Btvt"),o("Oyvg"),o("OG14"),o("pIFo");var s=o("v+DW");t.default={init(e,t){e.setOptions({bodyStyle:"padding:0;",onDestroy:function(){uiSearch.destroy(n),i&&i.destroy(),e=o=i=a=n=null}});var o,r,i,n=ge("video_live_blacklist_search"),a=ge("video_live_blacklist_wrap"),c=domByClass(a,"olist"),l={};function d(e){var s=e;if((e=trim(e).replace(/\s+/g," ").toLowerCase())!==r){r=e;var i=e?o.search(e):t.list,n="";if(i.length)for(var a,d=new RegExp(e,"i"),u=0;u<i.length;u++)a=i[u],n+=getTemplate("video_live_blacklist_item",{id:a.id,href:a.href,photo:a.photo,name:e?a.name.replace(d,"<em>$&</em>"):a.name,class:l[a.id]?" olist_item_wrap_on":""});else n=getTemplate("video_live_blacklist_empty",{text:langStr(getLang("global_search_not_found"),"search","<b>"+clean(s)+"</b>")});val(c,n)}}t.list.length&&(e.removeButtons().addButton(getLang("global_save"),(function(o){ajax.post("al_video.php?act=save_live_blacklist",{exclude:Object.keys(l).join(","),hash:t.save_hash},{onDone:function(t){e.hide(),t&&showDoneBox(t)},showProgress:s.lockButton.pbind(o),hideProgress:s.unlockButton.pbind(o)})})).addButton(getLang("global_cancel"),null,"no"),i=new uiScroll(a),d(""),a.onclick=function(e){var t=domClosest("olist_item_wrap",e.target);if(!t)return;cancelEvent(e);var o=domData(t,"id");toggleClass(t,"olist_item_wrap_on")?l[o]=1:delete l[o]},n&&(o=new vkIndexer(t.list,(function(e){return e.name+" https://vk.com"+e.href})),uiSearch.init(n,{onChange:d}),uiSearch.focus(n)))}}}});