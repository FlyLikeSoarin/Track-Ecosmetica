(window.webpackJsonp=window.webpackJsonp||[]).push([["d14cf8a35640ddac42850d9e4cb772f6"],{"2vnv":function(e,n,r){"use strict";r.r(n),r.d(n,"friendsRecommInit",(function(){return v})),r.d(n,"onViewFriendRecomm",(function(){return g})),r.d(n,"friendsRecommLogSave",(function(){return R})),r.d(n,"friendsRecommLogGet",(function(){return j})),r.d(n,"friendsRecommLogClear",(function(){return E})),r.d(n,"friendsRecommLogCheckVisited",(function(){return p})),r.d(n,"friendsRecommLogSend",(function(){return D})),r.d(n,"friendsRecommLogOnFail",(function(){return y})),r.d(n,"FriendsRecommendGlobals",(function(){return L}));var t,o=r("zxIV"),i=r("Egk5"),c=r("EasH"),d=r("v+DW"),a=r("Xrg9"),u=r("t7n3"),s=r("D1OX"),l=r("3oLO"),f=r("4+be"),m=r("kcIO"),_=r("jE6c");!function(e){e[e.DELETED_USER=-5]="DELETED_USER",e[e.BLACKLISTED=-4]="BLACKLISTED",e[e.FRIENDS_COUNT_EXCEEDED=-3]="FRIENDS_COUNT_EXCEEDED",e[e.FLOOD_CONTROL=-2]="FLOOD_CONTROL",e[e.SERVER_ERROR=-1]="SERVER_ERROR",e[e.NOT_FRIENDS=0]="NOT_FRIENDS",e[e.REQUEST_FROM_USER=1]="REQUEST_FROM_USER",e[e.REQUEST_TO_USER=2]="REQUEST_TO_USER",e[e.ARE_FRIENDS=3]="ARE_FRIENDS"}(t||(t={}));var w=r("Ieup"),O=function(){var e;return"feed"===window.cur.module&&window.Feed?null===(e=window.Feed)||void 0===e?void 0:e.getModuleRef():window.cur.module};function v(e,n){if(void 0===n&&(n={}),e){var r=Object(o.domData)(e,"from")||"user_rec",t=Object(o.domData)(e,"code"),i={scrollY:!1,onViewItem:function(e,t){var o;(null===(o=null==n?void 0:n.checkViewItem)||void 0===o?void 0:o.call(n,e))||g(e,t,r)}};Object(o.domData)(e,"next")&&(i.onLoadMore=function(){l.ajax.post("al_friends.php",{act:"a_recomm_friends_gallery",next:Object(o.domData)(e,"next"),track_code:t,friend_id:n.friendId||0},{onDone:function(n,r){var t,i=[];n&&(i=Object(o.domChildren)(Object(o.ce)("div",{innerHTML:n}))),null===(t=Object(s.uiGetGallery)(e))||void 0===t||t.addMore(i,!r),Object(o.domData)(e,"next",r||null)}})}),new s.UIGallery(e,i)}}function g(e,n,r){if(!e.viewed&&Object(o.hasClass)(e,"ui_gallery_item")){var t=+Object(o.domData)(e,"uid"),i=O(),c=b(e);R(["show_user_rec",t,Date.now(),n,i,r,c]),e.viewed=!0}}function b(e){var n,r=Object(o.domData)(e,"code");return r||(n=Object(o.gpeByClass)("ui_gallery",e),r=Object(o.domData)(n,"code")),r||""}function R(e,n){void 0===n&&(n=!1);var r=j();r.push(e),a.default.set("friends_recomm",r),D(n)}function j(e,n,r){void 0===e&&(e=!1),void 0===r&&(r=!1);var t=a.default.get("friends_recomm"),o=Array.isArray(t)?t:[];return n&&(o=o.filter((function(e){return(r?e[1]!==n:e[1]===n)&&Object(u.inArray)(e[0],["show_user_rec","open_user"])}))),e&&(o=o.map((function(e){return e.join("|")}))),o}function E(e){if(e){var n=j(!1,e,!0);n.length?a.default.set("friends_recomm",n):a.default.remove("friends_recomm")}else a.default.remove("friends_recomm");!function(e){if(e){var n=a.default.get("friends_recomm_visited")||{};delete n[e],a.default.set("friends_recomm_visited",n)}else a.default.remove("friends_recomm_visited")}(e)}function p(e){return(a.default.get("friends_recomm_visited")||{})[e]}function D(e){var n,r;void 0===e&&(e=!1),!(null===(n=window.cur)||void 0===n?void 0:n.friendsRecommLogIdle)&&(null===(r=null===window||void 0===window?void 0:window.curNotifier)||void 0===r?void 0:r.idle_manager)&&(Array.isArray(window.cur.onIdle)||(window.cur.onIdle=[]),Array.isArray(window.cur.onUnidle)||(window.cur.onUnidle=[]),window.cur.friendsRecommLogIdle=function(){clearTimeout(window.cur.friendsRecommLog)},window.cur.onIdle.push(window.cur.friendsRecommLogIdle),window.cur.onUnidle.push(D)),clearTimeout(window.cur.friendsRecommLog),e?h():window.cur.friendsRecommLog=window.setTimeout(h,1e4)}function h(){if(!window.cur.friendsRecommProcess){var e=j(!0);e.length&&(window.cur.friendsRecommProcess=!0,E(),l.ajax.post("al_friends.php",{act:"a_recomm_logs",logs:e},{onDone:function(){delete window.cur.friendsRecommProcess},onFail:function(){return y(e),delete window.cur.friendsRecommProcess,!0}}))}}function y(e){var n=j();n=e.map((function(e){return e.split("|")})).concat(n),a.default.set("friends_recomm",n)}var L={toggleRecommFriend:function(e,n,r){var a=Object(o.gpeByClass)("friend_recomm_card",e),u=a&&+Object(o.domData)(a,"uid");if(u){var s={act:"add",mid:u,hash:r,from:"user_rec",ref:O(),track_code:b(a),ts:Date.now()},v=j(!0,u);return v.length&&(E(u),s.logs=v),l.ajax.post("al_friends.php",s,{onDone:function(n,r){if(Object(o.val)(e,n),Object(o.addClass)(e,"secondary"),Object(d.disableButton)(e,!0),Object(o.addClass)(a,"friend_recomm_card_accepted"),Object(o.re)(Object(o.geByClass1)("wall_card_text_special",a)),function(e){if(Object(_.isObject)(e)){var n=e;return(null==n?void 0:n.result_code)===t.REQUEST_FROM_USER}return!1}(r)&&r.friend_request_add_sent_message_nudge){var c=n;Object(m.showDoneBoxFull)("",{},{tooltipHandler:(u=r.friend_request_entrypoint,function(e,n){var r=n.hide;Object(i.addEvent)(e.querySelector('[data-section-ref="friend_request_notification_send_message"]'),"click",(function(e){var n;if(e.currentTarget instanceof HTMLElement){var t=parseInt(null!==(n=e.currentTarget.getAttribute("data-message-user-id"))&&void 0!==n?n:"");if(!t||Object(i.checkEvent)(e))return!0;r(),Object(w.showWriteMessageBox)(e,t,{params:{box_custom_entrypoint:u}})}}))}),text:r.friend_request_add_sent_message_nudge,title:c})}var u},onFail:function(e){if(v&&y(v),e)return Object(c.showFastBox)(Object(f.getLang)("global_error"),e),!0},showProgress:function(){return Object(d.lockButton)(e)},hideProgress:function(){return Object(d.unlockButton)(e)}}),Object(i.cancelEvent)(n),!1}},hideRecommFriend:function(e,n,r){var t=Object(o.gpeByClass)("friend_recomm_card",e),a=t&&+Object(o.domData)(t,"uid");if(a){var u=Object(o.gpeByClass)("ui_gallery",e),m=O(),_=Object(o.domData)(t,"code")||Object(o.domData)(u,"code")||"";return l.ajax.post("al_friends.php",{act:"hide_possible",mid:a,ref:m,track_code:_,hash:r},{onDone:function(){var n=Object(s.uiGetGallery)(Object(o.gpeByClass)("ui_gallery",e));if(n){var r=Object(o.gpeByClass)("ui_gallery_item",e);n.removeItem(r)}},onFail:function(e){if(e)return Object(c.showFastBox)(Object(f.getLang)("global_error"),e),!0},showProgress:function(){return Object(d.lockButton)(e)},hideProgress:function(){return Object(d.unlockButton)(e)}}),Object(i.cancelEvent)(n),!1}},onClickRecommFriend:function(e){if(Object(o.hasClass)(e,"ui_gallery_item")||(e=Object(o.gpeByClass)("ui_gallery_item",e)),e){var n=+Object(o.domData)(e,"uid"),r=O(),t=b(e);!function(e,n,r){var t=a.default.get("friends_recomm_visited")||{};t[e]={ref:n,trackCode:r},a.default.set("friends_recomm_visited",t)}(n,r,t),R(["open_user",n,Date.now(),r,t])}}}}}]);try{stManager.done("cmodules/bundles/d14cf8a35640ddac42850d9e4cb772f6.4399e3f85bff28794db5.js")}catch(e){}